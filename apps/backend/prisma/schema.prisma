// This is your Prisma schema file

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Job {
  id          Int       @id @default(autoincrement())
  title       String    @db.VarChar(255)
  company     String?   @db.VarChar(255)
  category    String[]
  tags        String[]
  regionLimit String    @map("region_limit") @db.VarChar(50)
  workType    String    @map("work_type") @db.VarChar(50)
  sourceSite  String    @map("source_site") @db.VarChar(50)
  originalUrl String    @unique @map("original_url") @db.Text
  applyUrl    String?   @map("apply_url") @db.Text
  contentHash String    @unique @map("content_hash") @db.VarChar(64)
  description String?   @db.Text
  datePosted  DateTime? @map("date_posted")
  dateScraped DateTime  @default(now()) @map("date_scraped")
  isActive    Boolean   @default(true) @map("is_active")
  createdAt   DateTime  @default(now()) @map("created_at")
  updatedAt   DateTime  @updatedAt @map("updated_at")

  @@index([category])
  @@index([regionLimit])
  @@index([workType])
  @@index([datePosted(sort: Desc)])
  @@index([isActive])
  @@map("jobs")
}

model ScraperLog {
  id           Int       @id @default(autoincrement())
  sourceSite   String    @map("source_site") @db.VarChar(50)
  status       String    @db.VarChar(20)
  jobsScraped  Int       @default(0) @map("jobs_scraped")
  errorMessage String?   @map("error_message") @db.Text
  startedAt    DateTime  @default(now()) @map("started_at")
  completedAt  DateTime? @map("completed_at")

  @@map("scraper_logs")
}
